---
name: style-extractor
description: 从参考剧本或参考素材中提取统一风格锚点（STYLE_BASE），确保全剧视觉一致性。当需要匹配参考风格、提取画风、建立风格基准、生成风格资产包时使用。
---

# 风格提取器

从剧本或参考素材中提取统一风格锚点，**从预定义风格库中匹配最合适的风格**，生成风格资产包，确保全剧视觉一致性。

## 核心原则

- **风格库优先**：必须从预定义风格库中选择，禁止自定义风格
- **总风格先行**：所有镜头提示词的「风格段」只能引用 `STYLE_BASE` 或 `STYLE_VAR`，不得每镜头随意改写
- **变体只写增量**：STYLE_VAR 只允许写"与 BASE 不同的变化项（delta）"，禁止重写 BASE
- **一致性优先**：风格锚点一旦确定，全剧冻结，不可随意修改

## 预定义风格库

**重要：必须从以下风格中选择，不允许自定义风格！**

| ID | 风格名称 | 风格描述 | 参考图 |
|----|----------|----------|--------|
| 1 | 国风仙侠 | 二次元国风仙侠风格（国漫赛璐璐+轻厚涂融合，干净利落线稿，边缘锐利清晰，柔和日光高键光，明快高饱和配色，高清细节） | [预览](https://ts-web.oss-cn-hongkong.aliyuncs.com/styles/%E5%9B%BD%E9%A3%8E%E4%BB%99%E4%BE%A0.jpg) |
| 2 | 日漫新海诚 | 日漫新海诚风格（写实细腻的现代风格，高细节刻画与干净线稿，冷暖对比明显，体积光、边缘高光，电影级构图与景深，8k超高清，高质量） | [预览](https://ts-web.oss-cn-hongkong.aliyuncs.com/styles/%E6%97%A5%E6%BC%AB%E6%96%B0%E6%B5%B7%E8%AF%9A.jpg) |
| 3 | 宫崎骏 | 宫崎骏风格（温暖柔和的色彩，细腻且充满想象力的奇幻风格，治愈系氛围，高清高质量） | [预览](https://ts-web.oss-cn-hongkong.aliyuncs.com/styles/%E5%AE%AB%E5%B4%8E%E9%AA%8F.jpg) |
| 4 | 赛璐璐 | 赛璐璐风格（干净利落的线条，柔和的光影，明快的配色，适合表现清新可爱的画面） | [预览](https://ts-web.oss-cn-hongkong.aliyuncs.com/styles/%E8%B5%9B%E7%92%90%E7%92%90.jpg) |
| 5 | 奇幻卡通 | 奇幻卡通风格（明亮高饱和配色，夸张想象力的奇幻风格，圆润造型与简洁线条，柔和体积光与梦幻氛围，轻松幽默气质，高清细节） | [预览](https://ts-web.oss-cn-hongkong.aliyuncs.com/styles/%E5%A5%87%E5%B9%BB%E5%8D%A1%E9%80%9A.jpg) |
| 6 | 日漫异世界 | 日漫异世界风格（典型日系动画线稿与清晰描边，奇幻中世纪魔法风格，冷暖对比光影，电影感构图，高清高质量） | [预览](https://ts-web.oss-cn-hongkong.aliyuncs.com/styles/%E6%97%A5%E6%BC%AB%E5%BC%82%E4%B8%96%E7%95%8C.jpg) |
| 7 | 韩漫都市 | 韩漫都市风格（韩系网漫质感，线条干净利落，偏写实比例，柔和渐变上色与高光阴影塑形，清晰质感，高清） | [预览](https://ts-web.oss-cn-hongkong.aliyuncs.com/styles/%E9%9F%A9%E6%BC%AB%E9%83%BD%E5%B8%82.jpg) |
| 8 | 都市动漫 | 都市动漫风格（现代日常向二次元，干净线稿与清爽配色，柔和自然光与生活化场景细节，画面明快、节奏轻松，轻电影感构图，高清细节） | [预览](https://ts-web.oss-cn-hongkong.aliyuncs.com/styles/%E9%83%BD%E5%B8%82%E5%8A%A8%E6%BC%AB.jpg) |
| 9 | 校园日漫 | 校园日漫风格（日系动画风格，清新可爱的校园风格，简洁线条，青春活力与轻松幽默氛围，高清） | [预览](https://ts-web.oss-cn-hongkong.aliyuncs.com/styles/%E6%A0%A1%E5%9B%AD%E6%97%A5%E6%BC%AB.jpg) |

### 风格选择指南

| 剧本类型 | 推荐风格 |
|----------|----------|
| 古装仙侠/武侠/玄幻 | 国风仙侠(1) |
| 现代都市青春/恋爱 | 日漫新海诚(2)、都市动漫(8) |
| 治愈系/童话/奇幻冒险 | 宫崎骏(3)、奇幻卡通(5) |
| 日常番/轻喜剧 | 赛璐璐(4)、校园日漫(9) |
| 异世界/穿越/魔法 | 日漫异世界(6) |
| 现代都市/职场/悬疑 | 韩漫都市(7)、都市动漫(8) |
| 校园/青春/热血 | 校园日漫(9)、赛璐璐(4) |

## 输入要求

### 必填
- **剧本正文**：能看出场次、地点、人物、动作/对白

### 可选（越全越稳）
- **参考图/参考视频**：用于辅助判断风格匹配度
- **用户指定风格ID**：若用户明确指定，直接使用
- **项目类型**：古风/现代/赛博朋克/恐怖等

## 提取流程

### 步骤 1：分析剧本调性

阅读剧本，提取以下信息：
- 题材类型（仙侠/都市/悬疑/甜宠等）
- 时代背景（古代/现代/未来）
- 情绪基调（热血/压抑/温馨/恐怖）
- 场景特征（室内/室外/奇幻/写实）

### 步骤 2：从风格库匹配最佳风格

**必须从预定义风格库中选择！**

匹配规则：
1. 若用户指定了风格ID，直接使用该风格
2. 根据剧本调性，参照「风格选择指南」选择最匹配的风格
3. 若有多个合适风格，选择与剧本情绪最契合的一个
4. **禁止自定义风格，禁止修改风格库中的描述**

### 步骤 3：识别风格变体场景

扫描剧本，识别需要风格变体的场景：
- 回忆/闪回
- 梦境/幻觉
- 系统UI/游戏界面
- 战斗/高燃
- 恐怖/压迫

### 步骤 4：生成 STYLE_VAR（如需要）

为每个变体场景生成风格变体，只写与 BASE 的差异。

## 输出格式

### 1. STYLE_BASE（总风格锚点｜唯一权威）

```text
STYLE_BASE_ID：style_base_{项目短名}

匹配风格：
- 风格ID：{1-9}
- 风格名称：{风格库中的名称}
- 风格描述：{风格库中的完整描述，不可修改}
- 参考图：{风格库中的图片URL}

匹配理由：{简述为何选择此风格，2-3句话}

镜头语言默认值：
- 景别倾向：中近景为主，全景建立环境
- 焦段倾向：35-85mm 等效
- 景深倾向：浅景深突出主体
- 运动克制：静止为主，关键点微推

光色默认值：
- 主光方向：侧光/逆光
- 对比度：{根据风格调整}
- 饱和度：{根据风格调整}
- 氛围：{根据风格调整}

内容边界（禁止）：
- {禁止项1}
- {禁止项2}
- ...
```

### 2. STYLE_VAR（风格变体｜可选）

```text
StyleVarID：style_var_{项目短名}_{用途}

用途：{回忆/梦境/系统UI/战斗/恐怖}

delta（只写变化项）：
- 色彩：{饱和度/色温变化}
- 对比：{更硬/更软}
- 画面质感：{柔焦/颗粒/雾化}
- 镜头语言：{更手持/更稳/更慢}

禁忌：
- 禁止破坏 BASE 角色脸与服装的不可变特征
```

## 示例

### 输入：仙侠剧本

### 输出：

```text
STYLE_BASE_ID：style_base_jianlai

匹配风格：
- 风格ID：1
- 风格名称：国风仙侠
- 风格描述：二次元国风仙侠风格（国漫赛璐璐+轻厚涂融合，干净利落线稿，边缘锐利清晰，柔和日光高键光，明快高饱和配色，高清细节）
- 参考图：https://ts-web.oss-cn-hongkong.aliyuncs.com/styles/%E5%9B%BD%E9%A3%8E%E4%BB%99%E4%BE%A0.jpg

匹配理由：剧本为古装仙侠题材，包含修仙、飞剑、灵气等元素，国风仙侠风格的赛璐璐+轻厚涂融合最能表现仙侠世界的飘逸感与东方美学。

镜头语言默认值：
- 景别倾向：中近景为主，山水全景建立仙境
- 焦段倾向：50-85mm 等效，人像舒适
- 景深倾向：浅景深，云雾虚化
- 运动克制：静止为主，飞天动作跟拍

光色默认值：
- 主光方向：侧逆光，勾勒轮廓
- 对比度：柔和，层次分明
- 饱和度：明快高饱和
- 氛围：仙气飘渺，清冷出尘

内容边界（禁止）：
- 现代建筑、电线杆、玻璃幕墙
- 现代服饰、牛仔裤、运动鞋
- 血腥内脏、残肢断臂
- 枪械、汽车、手机
```

```text
StyleVarID：style_var_jianlai_flashback

用途：回忆/闪回

delta（只写变化项）：
- 色彩：降低饱和度30%，偏暖黄
- 对比：更柔，边缘朦胧
- 画面质感：轻微柔焦，边缘暗角
- 镜头语言：更慢，静止为主

禁忌：
- 禁止改变角色脸型、发型、服装主色
```

### 输入：现代都市甜宠剧本

### 输出：

```text
STYLE_BASE_ID：style_base_sweetlove

匹配风格：
- 风格ID：2
- 风格名称：日漫新海诚
- 风格描述：日漫新海诚风格（写实细腻的现代风格，高细节刻画与干净线稿，冷暖对比明显，体积光、边缘高光，电影级构图与景深，8k超高清，高质量）
- 参考图：https://ts-web.oss-cn-hongkong.aliyuncs.com/styles/%E6%97%A5%E6%BC%AB%E6%96%B0%E6%B5%B7%E8%AF%9A.jpg

匹配理由：现代都市背景的甜宠剧，新海诚风格的写实细腻与电影级构图能完美呈现都市场景的精致感，冷暖对比的光影适合表现恋爱氛围。

镜头语言默认值：
- 景别倾向：中近景为主，城市全景建立环境
- 焦段倾向：35-50mm 等效
- 景深倾向：浅景深，背景虚化光斑
- 运动克制：静止为主，情感高潮缓推

光色默认值：
- 主光方向：侧光/逆光，体积光
- 对比度：冷暖对比明显
- 饱和度：中高饱和
- 氛围：唯美浪漫，电影感

内容边界（禁止）：
- 古装元素、魔法特效
- 血腥暴力场景
- 过度夸张的表情变形
```

## 质量检查

生成后必须自检：
- [ ] 是否从风格库中选择了风格？（禁止自定义）
- [ ] 风格描述是否原封不动引用风格库？
- [ ] 匹配理由是否合理？
- [ ] STYLE_VAR 是否只写了 delta？
- [ ] 内容边界是否与所选风格一致？

## 额外资源

- 完整风格规则：[format-rules.md](references/format-rules.md)

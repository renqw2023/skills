# Context Restore UX è¯„ä¼°æŠ¥å‘Š

**è¯„ä¼°æ—¥æœŸ**: 2026-02-07  
**è¯„ä¼°è€…**: OpenClaw SubAgent  
**ç‰ˆæœ¬**: v1.0.0

---

## ğŸ“‹ ç›®å½•

1. [æ‰§è¡Œæ‘˜è¦](#æ‰§è¡Œæ‘˜è¦)
2. [æµ‹è¯•æ–¹æ³•](#æµ‹è¯•æ–¹æ³•)
3. [äº¤äº’æµç¨‹åˆ†æ](#äº¤äº’æµç¨‹åˆ†æ)
4. [è¾“å‡ºå¯è¯»æ€§è¯„ä¼°](#è¾“å‡ºå¯è¯»æ€§è¯„ä¼°)
5. [é”™è¯¯ä¿¡æ¯æ¸…æ™°åº¦è¯„ä¼°](#é”™è¯¯ä¿¡æ¯æ¸…æ™°åº¦è¯„ä¼°)
6. [å¸®åŠ©æ–‡æ¡£è´¨é‡è¯„ä¼°](#å¸®åŠ©æ–‡æ¡£è´¨é‡è¯„ä¼°)
7. [é›†æˆä½“éªŒè¯„ä¼°](#é›†æˆä½“éªŒè¯„ä¼°)
8. [å¯ç”¨æ€§é—®é¢˜æ±‡æ€»](#å¯ç”¨æ€§é—®é¢˜æ±‡æ€»)
9. [UX æ”¹è¿›å»ºè®®](#ux-æ”¹è¿›å»ºè®®)
10. [è¾“å‡ºæ ¼å¼ä¼˜åŒ–æ–¹æ¡ˆ](#è¾“å‡ºæ ¼å¼ä¼˜åŒ–æ–¹æ¡ˆ)

---

## 1. æ‰§è¡Œæ‘˜è¦

### æ•´ä½“è¯„åˆ†: 6.5/10

| è¯„ä¼°ç»´åº¦ | è¯„åˆ† | ä¸»è¦å‘ç° |
|---------|------|---------|
| äº¤äº’æµç¨‹ | 7/10 | åŸºç¡€åŠŸèƒ½å®Œæ•´ï¼Œä½†ç¼ºä¹æ™ºèƒ½è§¦å‘æœºåˆ¶ |
| è¾“å‡ºå¯è¯»æ€§ | 6/10 | ä¿¡æ¯ä¸°å¯Œä½†æ ¼å¼å¯ä¼˜åŒ– |
| é”™è¯¯ä¿¡æ¯ | 5/10 | é”™è¯¯ä¿¡æ¯è¿‡äºæŠ€æœ¯åŒ–ï¼Œç”¨æˆ·ä¸å‹å¥½ |
| å¸®åŠ©æ–‡æ¡£ | 8/10 | æ–‡æ¡£è¯¦ç»†ï¼Œä½†ç¤ºä¾‹ä¸å®é™…è¾“å‡ºä¸ä¸€è‡´ |
| é›†æˆä½“éªŒ | 6/10 | ç¼ºå°‘ Telegram å¹³å°çš„åŸç”Ÿé›†æˆ |

### æ ¸å¿ƒå‘ç°

1. âœ… **ä¼˜åŠ¿**:
   - ä¸‰çº§æŠ¥å‘Šçº§åˆ«è®¾è®¡åˆç†
   - é”™è¯¯å¤„ç†è¦†ç›–å…¨é¢
   - æ–‡æ¡£è¯¦å°½ï¼Œä¸­è‹±åŒè¯­æ”¯æŒ

2. âŒ **åŠ£åŠ¿**:
   - é»˜è®¤æ–‡ä»¶è·¯å¾„é…ç½®é—®é¢˜
   - Telegram æ¶ˆæ¯åˆ†å—å‘é€æœªå®ç°
   - è¾“å‡ºæ ¼å¼ä¸æŠ€æœ¯æ–‡æ¡£ç¤ºä¾‹ä¸ä¸€è‡´
   - ç¼ºå°‘ç”¨æˆ·ç¡®è®¤äº¤äº’æµç¨‹

---

## 2. æµ‹è¯•æ–¹æ³•

### æµ‹è¯•ç¯å¢ƒ
- **æ“ä½œç³»ç»Ÿ**: Linux 6.8.0-71-generic
- **Python ç‰ˆæœ¬**: 3.12+
- **æµ‹è¯•æ–‡ä»¶**: `/home/athur/.openclaw/workspace/compressed_context/latest_compressed.json`

### æµ‹è¯•åœºæ™¯

| åœºæ™¯ç¼–å· | æµ‹è¯•å†…å®¹ | é¢„æœŸç»“æœ | å®é™…ç»“æœ |
|---------|---------|---------|---------|
| TS-01 | Minimal çº§åˆ«è¾“å‡º | ç®€æ´æ‘˜è¦ | âœ… é€šè¿‡ |
| TS-02 | Normal çº§åˆ«è¾“å‡º | è¯¦ç»†æŠ¥å‘Š | âœ… é€šè¿‡ (æ ¼å¼åå·®) |
| TS-03 | Detailed çº§åˆ«è¾“å‡º | å®Œæ•´è½¬å‚¨ | âœ… é€šè¿‡ |
| TS-04 | æ–‡ä»¶ä¸å­˜åœ¨ | é”™è¯¯æç¤º | âœ… é€šè¿‡ |
| TS-05 | ç›¸å¯¹è·¯å¾„åŠ è½½ | è‡ªåŠ¨è§£æ | âŒ å¤±è´¥ |
| TS-06 | JSON æ ¼å¼æ”¯æŒ | æ­£ç¡®è§£æ | âœ… é€šè¿‡ |

### è¾“å‡ºè´¨é‡å¯¹æ¯”

#### SKILL.md æœŸæœ›è¾“å‡º vs å®é™…è¾“å‡º

**æœŸæœ›è¾“å‡º (Normal)**:
```
âœ… ä¸Šä¸‹æ–‡å·²æ¢å¤

å½“å‰æ´»è·ƒé¡¹ç›®ï¼š
1. ğŸ›ï¸ Hermes Plan - æ•°æ®åˆ†æåŠ©æ‰‹ï¼ˆè¿›åº¦ï¼š80%ï¼‰
2. ğŸŒ Akasha Plan - è‡ªä¸»æ–°é—»ç³»ç»Ÿï¼ˆè¿›åº¦ï¼š45%ï¼‰

å¾…åŠä»»åŠ¡ï¼š
- [é«˜] ç¼–å†™æ•°æ®ç®¡é“æµ‹è¯•ç”¨ä¾‹
- [ä¸­] è®¾è®¡ Akasha UI ç»„ä»¶
- [ä½] æ›´æ–° README æ–‡æ¡£

æœ€è¿‘æ“ä½œï¼ˆä»Šå¤©ï¼‰ï¼š
- å®Œæˆæ•°æ®æ¸…æ´—æ¨¡å—
- æ·»åŠ  3 ä¸ªæ–° cron ä»»åŠ¡
- ä¿®æ”¹é…ç½®æ–‡ä»¶
```

**å®é™…è¾“å‡º (Normal)**:
```
============================================================
CONTEXT RESTORE REPORT (Normal)
============================================================

ğŸ“Š Context Compression Info:
   Original messages: 45
   Compressed messages: 12
   Timestamp: 2026-02-06T23:30:00.000
   Compression ratio: 26.7%

ğŸ”„ Recent Operations (4)
   â€¢ **ä¸Šä¸‹æ–‡å·²æ¢å¤**
   â€¢ 11ä¸ªcronä»»åŠ¡å·²è½¬ä¸º isolated mode
   ...

ğŸ“ Hermes Plan
   Description: Data analysis assistant for Excel, documents, and reports
   Status: Active
```

**å·®å¼‚åˆ†æ**:
1. ç¼ºå°‘"âœ… ä¸Šä¸‹æ–‡å·²æ¢å¤"ç¡®è®¤æ¶ˆæ¯
2. ç¼ºå°‘è¿›åº¦ç™¾åˆ†æ¯”
3. ç¼ºå°‘ä¼˜å…ˆçº§æ ‡ç­¾ [é«˜/ä¸­/ä½]
4. ç¼ºå°‘æ“ä½œå»ºè®®å—
5. ä½¿ç”¨è‹±æ–‡åˆ†éš”ç¬¦è€Œéä¸­æ–‡å‹å¥½æ ¼å¼

---

## 3. äº¤äº’æµç¨‹åˆ†æ

### å½“å‰æµç¨‹å›¾

```
ç”¨æˆ·è¾“å…¥ â†’ æ„å›¾è¯†åˆ« â†’ æ–‡ä»¶åŠ è½½ â†’ è§£æ â†’ æ ¼å¼åŒ– â†’ è¾“å‡º
                    â†“
                é”™è¯¯å¤„ç† â†’ é”™è¯¯æ¶ˆæ¯
```

### é—®é¢˜åˆ†æ

#### 3.1 è§¦å‘æ–¹å¼é—®é¢˜

| é—®é¢˜ | ä¸¥é‡ç¨‹åº¦ | æè¿° |
|-----|---------|------|
| è·¯å¾„ç¡¬ç¼–ç  | ä¸­ | é»˜è®¤è·¯å¾„ `./compressed_context/` ç›¸å¯¹äºè„šæœ¬ä½ç½®ï¼Œè€Œéè°ƒç”¨ä½ç½® |
| ç¼ºå°‘æ™ºèƒ½è§¦å‘ | é«˜ | ä¾èµ–ç”¨æˆ·æ‰‹åŠ¨è¾“å…¥å…³é”®è¯ï¼Œè€Œéè‡ªåŠ¨æ£€æµ‹ |
| æ— å¯¹è¯é›†æˆ | é«˜ | Telegram ä¸­æ— æ³•ç›´æ¥ä»¥ `/context-restore` è§¦å‘ |

#### 3.2 äº¤äº’æµç¨‹é—®é¢˜

```mermaid
graph TD
    A[ç”¨æˆ·è¿›å…¥æ–°ä¼šè¯] --> B{æ˜¯å¦è¯´'ç»§ç»­ä¹‹å‰çš„å·¥ä½œ'}
    B -->|æ˜¯| C[æ‰‹åŠ¨è§¦å‘ context-restore]
    B -->|å¦| D[æ–°ä¼šè¯ï¼Œæ— ä¸Šä¸‹æ–‡]
    
    C --> E[è¾“å‡ºæ¢å¤æŠ¥å‘Š]
    E --> F{ç”¨æˆ·ç¡®è®¤}
    F -->|ç›´æ¥ç»§ç»­| G[å‡è®¾ç”¨æˆ·å·²é˜…è¯»]
    F -->|éœ€è¦è¯¦æƒ…| H[ç”¨æˆ·è¿½é—®]
    
    G --> I[ç»§ç»­å·¥ä½œ]
    H --> E
```

**ç¼ºå¤±ç¯èŠ‚**:
1. âŒ è‡ªåŠ¨ä¸Šä¸‹æ–‡æ¢å¤æç¤º
2. âŒ ç”¨æˆ·ç¡®è®¤æ­¥éª¤
3. âŒ æ¢å¤åçš„æ“ä½œå»ºè®®
4. âŒ Telegram åŸç”Ÿå‘½ä»¤æ”¯æŒ

### æ”¹è¿›å»ºè®®

1. **æ™ºèƒ½è§¦å‘**: é¦–æ¬¡å¯¹è¯æ—¶è‡ªåŠ¨æ£€æµ‹æ˜¯å¦éœ€è¦æ¢å¤ä¸Šä¸‹æ–‡
2. **ç¡®è®¤æœºåˆ¶**: è¾“å‡ºæ¢å¤æŠ¥å‘Šåæ·»åŠ "ç»§ç»­"ç¡®è®¤æŒ‰é’®
3. **å‘½ä»¤é›†æˆ**: æ”¯æŒ `/restore` å’Œ `/context` å¿«æ·å‘½ä»¤

---

## 4. è¾“å‡ºå¯è¯»æ€§è¯„ä¼°

### 4.1 æ ¼å¼è§„èŒƒæ€§

#### Minimal çº§åˆ« (è¯„åˆ†: 7/10)

```
============================================================
CONTEXT RESTORE REPORT (Minimal)
============================================================

ğŸ“Š Context Status:
   Messages: 45 â†’ 12

ğŸš€ Key Projects (3)
   â€¢ Hermes Plan
   â€¢ Akasha Plan
   â€¢ Morning Brief

ğŸ“‹ Ongoing Tasks (3)
   â€¢ Isolated Sessions
   â€¢ Cron Tasks
   â€¢ Main Session

============================================================
```

**ä¼˜ç‚¹**:
- âœ… ç®€æ´æ˜äº†
- âœ… ä¿¡æ¯å¯†åº¦é€‚ä¸­
- âœ… åˆ†ç±»æ¸…æ™°

**é—®é¢˜**:
- âŒ ç¼ºå°‘"ä¸Šä¸‹æ–‡å·²æ¢å¤"ç¡®è®¤
- âŒ ç¼ºå°‘æ—¶é—´ä¿¡æ¯
- âŒ æ— æ“ä½œå»ºè®®

#### Normal çº§åˆ« (è¯„åˆ†: 6/10)

**ä¼˜ç‚¹**:
- âœ… åŒ…å«å‹ç¼©ç‡åˆ†æ
- âœ… è¯¦ç»†çš„é¡¹ç›®æè¿°
- âœ… ä»»åŠ¡çŠ¶æ€å®Œæ•´

**é—®é¢˜**:
- âŒ è‹±æ–‡åˆ†éš”ç¬¦ (`====`) å¯¹ä¸­æ–‡ç”¨æˆ·ä¸å‹å¥½
- âŒ ç¼ºå°‘è¿›åº¦ç™¾åˆ†æ¯”
- âŒ MEMORY é«˜äº®æœªè§¦å‘
- âŒ æ—¶é—´æ ¼å¼ä¸å¤Ÿå‹å¥½ (`2026-02-06T23:30:00.000`)

#### Detailed çº§åˆ« (è¯„åˆ†: 5/10)

**é—®é¢˜**:
- âŒ JSON æ ¼å¼çš„å†…éƒ¨è½¬å‚¨ä¸é€‚åˆç»ˆç«¯ç”¨æˆ·
- âŒ åŸå§‹å†…å®¹é¢„è§ˆè¿‡é•¿
- âŒ ç¼ºå°‘è°ƒè¯•æ¨¡å¼å¼€å…³

### 4.2 ä¿¡æ¯æ¶æ„è¯„ä¼°

| ä¿¡æ¯ç±»å‹ | è¦†ç›–åº¦ | å¯å‘ç°æ€§ | ä¼˜å…ˆçº§ |
|---------|--------|---------|--------|
| é¡¹ç›®çŠ¶æ€ | 100% | é«˜ | å¿…è¦ |
| ä»»åŠ¡åˆ—è¡¨ | 100% | é«˜ | å¿…è¦ |
| æœ€è¿‘æ“ä½œ | 75% | ä¸­ | é‡è¦ |
| MEMORY å¼•ç”¨ | 0% | æ—  | è¾…åŠ© |
| æ“ä½œå»ºè®® | 0% | æ—  | é‡è¦ |

### 4.3 Telegram å¹³å°é€‚é…é—®é¢˜

å½“å‰è¾“å‡ºæ ¼å¼é—®é¢˜:
1. **è¿‡é•¿æ¶ˆæ¯**: Normal çº§åˆ«è¾“å‡ºçº¦ 500+ å­—ç¬¦ï¼Œéœ€åˆ†å—å‘é€
2. **æ—  Markdown**: Telegram æ”¯æŒ Markdownï¼Œä½†å½“å‰æœªä½¿ç”¨
3. **æ— æŒ‰é’®**: ç¼ºå°‘å¿«æ·æ“ä½œæŒ‰é’®
4. **emoji ä½¿ç”¨**: éƒ¨åˆ† emoji åœ¨éƒ¨åˆ†è®¾å¤‡ä¸Šæ˜¾ç¤ºä¸ºæ–¹å—

---

## 5. é”™è¯¯ä¿¡æ¯æ¸…æ™°åº¦è¯„ä¼°

### 5.1 å½“å‰é”™è¯¯ç±»å‹

| é”™è¯¯åœºæ™¯ | å½“å‰æ¶ˆæ¯ | ç”¨æˆ·å‹å¥½åº¦ |
|---------|---------|-----------|
| æ–‡ä»¶ä¸å­˜åœ¨ | `âŒ Error: File not found: ./compressed_context/latest_compressed.json` | â­â­â­ |
| æƒé™é”™è¯¯ | `âŒ Error: Permission denied: {filepath}` | â­â­â­ |
| è§£æå¤±è´¥ | `âŒ Unexpected error loading context: {e}` | â­â­ |
| æ— æ•ˆçº§åˆ« | `âŒ Error: Invalid level: xxx. Must be one of: minimal, normal, detailed` | â­â­â­ |

### 5.2 é—®é¢˜åˆ†æ

1. **æŠ€æœ¯æœ¯è¯­è¿‡å¤š**: "FileNotFoundError", "JSONDecodeError" ç­‰æœ¯è¯­å¯¹æ™®é€šç”¨æˆ·ä¸å‹å¥½
2. **ç¼ºå°‘æ“ä½œå»ºè®®**: é”™è¯¯åæœªæä¾›è§£å†³æ–¹æ¡ˆ
3. **ç¼ºå°‘æ¢å¤å»ºè®®**: ä¸Šä¸‹æ–‡æ–‡ä»¶æŸåæ—¶æœªæä¾›è‡ªåŠ¨æ¢å¤é€‰é¡¹
4. **æ—¥å¿—å†—ä½™**: å¼€å‘è°ƒè¯•ä¿¡æ¯ä¸ç”¨æˆ·æ¶ˆæ¯æ··åœ¨ä¸€èµ·

### 5.3 æ”¹è¿›ç¤ºä¾‹

**å½“å‰**:
```
âŒ Error: File not found: ./compressed_context/latest_compressed.json
```

**æ”¹è¿›å**:
```
âš ï¸ æœªæ‰¾åˆ°å†å²ä¸Šä¸‹æ–‡æ–‡ä»¶

å¯èƒ½åŸå› ï¼š
â€¢ è¿™æ˜¯æ‚¨çš„é¦–æ¬¡ä¼šè¯
â€¢ ä¸Šä¸‹æ–‡æ–‡ä»¶å·²è¢«æ¸…ç†

ğŸ’¡ å»ºè®®ï¼šä»æ–°ä¼šè¯å¼€å§‹ï¼Œæˆ‘å°†ä¸ºæ‚¨åˆ›å»ºæ–°çš„ä¸Šä¸‹æ–‡è®°å½•ã€‚
```

---

## 6. å¸®åŠ©æ–‡æ¡£è´¨é‡è¯„ä¼°

### 6.1 æ–‡æ¡£è¦†ç›–ç‡

| æ–‡æ¡£ç±»å‹ | è¦†ç›–ç‡ | è´¨é‡ |
|---------|--------|------|
| åŠŸèƒ½è¯´æ˜ | 100% | ä¼˜ |
| ä½¿ç”¨ç¤ºä¾‹ | 80% | è‰¯ |
| API æ–‡æ¡£ | 100% | ä¼˜ |
| æ•…éšœæ’é™¤ | 60% | ä¸­ |
| æœ€ä½³å®è·µ | 100% | ä¼˜ |

### 6.2 ä¸»è¦é—®é¢˜

1. **ç¤ºä¾‹ä¸å®é™…ä¸ä¸€è‡´**: SKILL.md ä¸­çš„ç¤ºä¾‹è¾“å‡ºä¸å®é™…è„šæœ¬è¾“å‡ºå·®å¼‚è¾ƒå¤§
2. **ç¼ºå°‘å¿«é€Ÿå‚è€ƒå¡**: Telegram å‘½ä»¤é€ŸæŸ¥è¡¨ç¼ºå¤±
3. **è§†é¢‘æ•™ç¨‹ç¼ºå¤±**: æ— äº¤äº’å¼æ¼”ç¤º

### 6.3 æ–‡æ¡£æ”¹è¿›å»ºè®®

1. æ›´æ–°ç¤ºä¾‹è¾“å‡ºä»¥åŒ¹é…å®é™…è¾“å‡º
2. æ·»åŠ  Telegram å‘½ä»¤é€ŸæŸ¥è¡¨
3. æ·»åŠ äº¤äº’å¼æ¼”ç¤ºå‘½ä»¤

---

## 7. é›†æˆä½“éªŒè¯„ä¼°

### 7.1 ä¸ä¸»ä¼šè¯çš„é›†æˆ

| é›†æˆç‚¹ | çŠ¶æ€ | æè¿° |
|-------|------|------|
| å…³é”®è¯è§¦å‘ | âœ… | æ”¯æŒä¸­è‹±æ–‡å…³é”®è¯ |
| å‘½ä»¤è§¦å‘ | âœ… | æ”¯æŒ `/context-restore` |
| è‡ªåŠ¨è§¦å‘ | âŒ | æ— æ™ºèƒ½è‡ªåŠ¨è§¦å‘ |
| ä¸Šä¸‹æ–‡æ¢å¤ | âœ… | è¯»å–å‹ç¼©ä¸Šä¸‹æ–‡ |
| ç”¨æˆ·ç¡®è®¤ | âŒ | æ— ç¡®è®¤æµç¨‹ |

### 7.2 Telegram é›†æˆé—®é¢˜

1. âŒ æ—  `/restore` å‘½ä»¤åˆ«å
2. âŒ è¾“å‡ºè¿‡é•¿æœªåˆ†å—
3. âŒ æ— å†…è”æŒ‰é’®æ”¯æŒ
4. âŒ æ— ä¼šè¯çŠ¶æ€æŒä¹…åŒ–

---

## 8. å¯ç”¨æ€§é—®é¢˜æ±‡æ€»

### 8.1 å…³é”®é—®é¢˜ (P0)

| ID | é—®é¢˜ | å½±å“ | ä¼˜å…ˆçº§ |
|----|------|------|--------|
| P0-01 | é»˜è®¤æ–‡ä»¶è·¯å¾„é”™è¯¯ | ç”¨æˆ·æ— æ³•ç›´æ¥è¿è¡Œ | é«˜ |
| P0-02 | è¾“å‡ºæ ¼å¼ä¸æ–‡æ¡£ä¸ç¬¦ | ç”¨æˆ·æœŸæœ›è½å·® | é«˜ |
| P0-03 | ç¼ºå°‘ç”¨æˆ·ç¡®è®¤æµç¨‹ | å¯èƒ½è·³è¿‡é‡è¦ä¿¡æ¯ | é«˜ |

### 8.2 é‡è¦é—®é¢˜ (P1)

| ID | é—®é¢˜ | å½±å“ | ä¼˜å…ˆçº§ |
|----|------|------|--------|
| P1-01 | Telegram æ¶ˆæ¯è¿‡é•¿ | æ¶ˆæ¯å¯èƒ½è¢«æˆªæ–­ | ä¸­ |
| P1-02 | é”™è¯¯ä¿¡æ¯ä¸å¤Ÿå‹å¥½ | ç”¨æˆ·å›°æƒ‘ | ä¸­ |
| P1-03 | ç¼ºå°‘æ“ä½œå»ºè®® | ç”¨æˆ·ä¸çŸ¥ä¸‹ä¸€æ­¥ | ä¸­ |
| P1-04 | æ—  MEMORY é«˜äº® | é—æ¼é‡è¦ä¿¡æ¯ | ä¸­ |

### 8.3 æ¬¡è¦é—®é¢˜ (P2)

| ID | é—®é¢˜ | å½±å“ | ä¼˜å…ˆçº§ |
|----|------|------|--------|
| P2-01 | è‹±æ–‡åˆ†éš”ç¬¦ | ä¸­æ–‡ç”¨æˆ·ä¸å‹å¥½ | ä½ |
| P2-02 | æ—¶é—´æ ¼å¼ | ä¸å¤Ÿç›´è§‚ | ä½ |
| P2-03 | è¿›åº¦ä¿¡æ¯ç¼ºå¤± | ä¿¡æ¯ä¸å®Œæ•´ | ä½ |

---

## 9. UX æ”¹è¿›å»ºè®®

### 9.1 çŸ­æœŸæ”¹è¿› (1-2å‘¨)

#### 9.1.1 ä¿®å¤æ–‡ä»¶è·¯å¾„é—®é¢˜

```python
# å½“å‰é—®é¢˜
DEFAULT_CONTEXT_FILE = './compressed_context/latest_compressed.json'

# æ”¹è¿›æ–¹æ¡ˆ
def get_context_file_path():
    # ä¼˜å…ˆä½¿ç”¨ç¯å¢ƒå˜é‡
    env_path = os.environ.get('OPENCLAW_CONTEXT_FILE')
    if env_path and os.path.exists(env_path):
        return env_path
    
    # å…¶æ¬¡ä½¿ç”¨æ ‡å‡†ä½ç½®
    standard_paths = [
        './compressed_context/latest_compressed.json',
        '/home/athur/.openclaw/workspace/compressed_context/latest_compressed.json',
        '../compressed_context/latest_compressed.json'
    ]
    
    for path in standard_paths:
        if os.path.exists(path):
            return path
    
    return None
```

#### 9.1.2 ç»Ÿä¸€è¾“å‡ºæ ¼å¼

```python
# æ”¹è¿›åçš„ Normal çº§åˆ«è¾“å‡ºæ ¼å¼
def format_normal_report_v2(content: str) -> str:
    lines = []
    
    # 1. ç¡®è®¤æ¶ˆæ¯
    lines.append("âœ… **ä¸Šä¸‹æ–‡å·²æ¢å¤**")
    lines.append("")
    
    # 2. ä¼šè¯æ¦‚è§ˆ
    lines.append("ğŸ“Š **ä¼šè¯æ¦‚è§ˆ**")
    lines.append(f"â€¢ åŸå§‹æ¶ˆæ¯: {original} â†’ å‹ç¼©å: {compressed} ({ratio:.0f}%)")
    lines.append(f"â€¢ æœ€åæ´»åŠ¨: {format_timestamp(timestamp)}")
    lines.append("")
    
    # 3. æ´»è·ƒé¡¹ç›®
    lines.append("ğŸš€ **æ´»è·ƒé¡¹ç›®**")
    for i, project in enumerate(projects, 1):
        lines.append(f"{i}. **{project['name']}**")
        lines.append(f"   {project['description']}")
        if project.get('progress'):
            lines.append(f"   è¿›åº¦: {project['progress']}%")
    lines.append("")
    
    # 4. å¾…åŠä»»åŠ¡
    lines.append("ğŸ“‹ **å¾…åŠä»»åŠ¡**")
    for task in tasks:
        priority_emoji = {'é«˜': 'ğŸ”´', 'ä¸­': 'ğŸŸ¡', 'ä½': 'ğŸŸ¢'}.get(task.get('priority', ''), 'âšª')
        lines.append(f"{priority_emoji} {task['task']}")
    lines.append("")
    
    # 5. æ“ä½œå»ºè®®
    lines.append("ğŸ’¡ **å»ºè®®æ“ä½œ**")
    lines.append("â€¢ è¾“å…¥ä»»åŠ¡åç§°ç»§ç»­å·¥ä½œ")
    lines.append("â€¢ è¯´ \"æŸ¥çœ‹è¯¦æƒ…\" è·å–æ›´å¤šä¿¡æ¯")
    lines.append("â€¢ è¯´ \"æ–°ä»»åŠ¡\" å¼€å§‹æ–°å·¥ä½œ")
    
    return '\n'.join(lines)
```

#### 9.1.3 æ”¹è¿›é”™è¯¯ä¿¡æ¯

```python
def format_error_message(error_type: str, details: str) -> str:
    error_messages = {
        'file_not_found': """
âš ï¸ **æœªæ‰¾åˆ°ä¸Šä¸‹æ–‡æ–‡ä»¶**

è¿™å¯èƒ½æ˜¯ä»¥ä¸‹æƒ…å†µï¼š
â€¢ é¦–æ¬¡ä½¿ç”¨ OpenClaw
â€¢ ä¸Šä¸‹æ–‡æ–‡ä»¶å·²è¢«æ¸…ç†

ğŸ’¡ ä»æ–°ä¼šè¯å¼€å§‹ï¼Œæˆ‘å°†è®°å½•æ–°çš„ä¸Šä¸‹æ–‡ã€‚
        """,
        'permission_denied': """
âš ï¸ **æ— æ³•è®¿é—®ä¸Šä¸‹æ–‡æ–‡ä»¶**

æƒé™ä¸è¶³ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æƒé™æˆ–è”ç³»ç®¡ç†å‘˜ã€‚
        """,
        'parse_error': """
âš ï¸ **ä¸Šä¸‹æ–‡æ–‡ä»¶å¼‚å¸¸**

æ–‡ä»¶æ ¼å¼æŸåï¼Œæ­£åœ¨å°è¯•æ¢å¤...
        """
    }
    return error_messages.get(error_type, f"âŒ é”™è¯¯: {details}")
```

### 9.2 ä¸­æœŸæ”¹è¿› (2-4å‘¨)

#### 9.2.1 Telegram é›†æˆå¢å¼º

```python
class TelegramContextRestore:
    def format_for_telegram(self, report: str, level: str) -> list:
        """å°†æŠ¥å‘Šåˆ†å—å‘é€ä»¥é€‚åº” Telegram é™åˆ¶"""
        max_length = 4000  # Telegram æ¶ˆæ¯é™åˆ¶
        
        if len(report) <= max_length:
            return [report]
        
        # æŒ‰ç« èŠ‚åˆ†å—
        chunks = []
        current_chunk = ""
        
        for line in report.split('\n'):
            if len(current_chunk) + len(line) + 1 > max_length:
                chunks.append(current_chunk)
                current_chunk = line
            else:
                current_chunk += '\n' + line if current_chunk else line
        
        if current_chunk:
            chunks.append(current_chunk)
        
        return chunks
    
    def create_inline_keyboard(self) -> dict:
        """åˆ›å»ºå†…è”é”®ç›˜æŒ‰é’®"""
        return {
            'inline_keyboard': [
                [
                    {'text': 'ğŸ“‹ è¯¦ç»†æŠ¥å‘Š', 'callback_data': 'ctx_detail'},
                    {'text': 'ğŸš€ ç»§ç»­é¡¹ç›®', 'callback_data': 'ctx_continue'}
                ],
                [
                    {'text': 'â¡ï¸ ç›´æ¥ç»§ç»­', 'callback_data': 'ctx_skip'},
                    {'text': 'â“ å¸®åŠ©', 'callback_data': 'ctx_help'}
                ]
            ]
        }
```

#### 9.2.2 æ™ºèƒ½è§¦å‘æœºåˆ¶

```python
class ContextRestoreTrigger:
    def should_auto_trigger(self, user_message: str, session_history: list) -> bool:
        """åˆ¤æ–­æ˜¯å¦åº”è¯¥è‡ªåŠ¨è§¦å‘ä¸Šä¸‹æ–‡æ¢å¤"""
        
        # è§¦å‘å…³é”®è¯
        triggers = [
            'ç»§ç»­ä¹‹å‰çš„å·¥ä½œ', 'restore context', 'continue previous work',
            'ä¹‹å‰èŠåˆ°å“ªäº†', 'what was I doing', 'æ¥ç€åš'
        ]
        
        # æ£€æŸ¥ç”¨æˆ·æ¶ˆæ¯æ˜¯å¦åŒ…å«è§¦å‘è¯
        if any(trigger in user_message.lower() for trigger in triggers):
            return True
        
        # æ£€æŸ¥æ˜¯å¦æ˜¯ä¼šè¯å¼€å§‹
        if len(session_history) == 0 and self.has_compressed_context():
            return True
        
        return False
    
    def get_auto_response(self, context_report: str) -> str:
        """ç”Ÿæˆè‡ªåŠ¨è§¦å‘æ—¶çš„å“åº”"""
        return f"""
ğŸ¤– æ£€æµ‹åˆ°æ‚¨æƒ³ç»§ç»­ä¹‹å‰çš„å·¥ä½œ...

{context_report}

---
ğŸ’¡ è¾“å…¥ä»»åŠ¡åç§°ç»§ç»­ï¼Œæˆ–è¯´ "æŸ¥çœ‹è¯¦æƒ…" è·å–æ›´å¤šä¿¡æ¯ã€‚
        """
```

### 9.3 é•¿æœŸæ”¹è¿› (1-2æœˆ)

#### 9.3.1 ä¸Šä¸‹æ–‡æ¢å¤å‘å¯¼

```python
class ContextRestoreWizard:
    """åˆ†æ­¥å¼•å¯¼ç”¨æˆ·å®Œæˆä¸Šä¸‹æ–‡æ¢å¤"""
    
    STEPS = [
        {
            'name': 'welcome',
            'message': "ğŸ‘‹ æ¬¢è¿å›æ¥ï¼è®©æˆ‘æ¢å¤æ‚¨çš„å·¥ä½œä¸Šä¸‹æ–‡...",
            'action': 'load_context'
        },
        {
            'name': 'summary',
            'message': None,  # åŠ¨æ€ç”Ÿæˆ
            'action': 'show_summary'
        },
        {
            'name': 'confirm',
            'message': "ä»¥ä¸Šæ˜¯æ‚¨çš„å½“å‰å·¥ä½œçŠ¶æ€ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ",
            'action': 'wait_confirmation'
        },
        {
            'name': 'continue',
            'message': "å¥½çš„ï¼Œå¼€å§‹ç»§ç»­ä¹‹å‰çš„å·¥ä½œã€‚",
            'action': 'handoff'
        }
    ]
```

#### 9.3.2 ä¸Šä¸‹æ–‡è´¨é‡è¯„åˆ†

```python
def calculate_context_quality(context: dict) -> dict:
    """è®¡ç®—ä¸Šä¸‹æ–‡æ¢å¤çš„è´¨é‡è¯„åˆ†"""
    
    score = 0
    max_score = 100
    issues = []
    
    # é¡¹ç›®ä¿¡æ¯å®Œæ•´æ€§ (40åˆ†)
    if len(context.get('projects', [])) >= 2:
        score += 20
    if all(p.get('description') for p in context.get('projects', [])):
        score += 20
    else:
        issues.append("éƒ¨åˆ†é¡¹ç›®ç¼ºå°‘æè¿°")
    
    # ä»»åŠ¡ä¿¡æ¯å®Œæ•´æ€§ (30åˆ†)
    if len(context.get('tasks', [])) >= 2:
        score += 15
    if all(t.get('status') for t in context.get('tasks', [])):
        score += 15
    else:
        issues.append("éƒ¨åˆ†ä»»åŠ¡ç¼ºå°‘çŠ¶æ€")
    
    # æ—¶é—´æœ‰æ•ˆæ€§ (20åˆ†)
    context_age = get_context_age(context.get('timestamp'))
    if context_age < 24:  # å°äº24å°æ—¶
        score += 20
    elif context_age < 48:
        score += 10
    else:
        issues.append("ä¸Šä¸‹æ–‡æ—¶é—´è¾ƒæ—§ï¼Œå¯èƒ½éœ€è¦æ›´æ–°")
    
    # æ“ä½œå†å² (10åˆ†)
    if context.get('operations'):
        score += 10
    
    return {
        'score': score,
        'grade': 'A' if score >= 80 else 'B' if score >= 60 else 'C',
        'issues': issues,
        'recommendation': get_recommendation(score, issues)
    }
```

---

## 10. è¾“å‡ºæ ¼å¼ä¼˜åŒ–æ–¹æ¡ˆ

### 10.1 Telegram ä¼˜åŒ–æ ¼å¼

#### æ¶ˆæ¯åˆ†å—ç­–ç•¥

```markdown
# æ¶ˆæ¯1: ç¡®è®¤ + æ¦‚è§ˆ
âœ… **ä¸Šä¸‹æ–‡å·²æ¢å¤**

ğŸ“Š **ä¼šè¯æ¦‚è§ˆ**
â€¢ æ—¶é—´: 2å°æ—¶å‰
â€¢ æ¶ˆæ¯: 45 â†’ 12 (å‹ç¼©ç‡ 27%)
â€¢ æ´»è·ƒä¼šè¯: 3

# æ¶ˆæ¯2: é¡¹ç›®åˆ—è¡¨
ğŸš€ **æ´»è·ƒé¡¹ç›®** (3)

1. **Hermes Plan** ğŸ›ï¸
   æ•°æ®åˆ†æåŠ©æ‰‹ï¼Œè¿›åº¦ 80%

2. **Akasha Plan** ğŸŒ
   è‡ªä¸»æ–°é—»ç³»ç»Ÿï¼Œè¿›åº¦ 45%

3. **Morning Brief** ğŸ“°
   æ™¨é—´ç®€æŠ¥ï¼Œæ¯å¤© 8 AM

# æ¶ˆæ¯3: ä»»åŠ¡ + å»ºè®®
ğŸ“‹ **å¾…åŠä»»åŠ¡** (3)

ğŸ”´ é«˜ä¼˜å…ˆçº§
   â€¢ æ•°æ®ç®¡é“æµ‹è¯•ç”¨ä¾‹

ğŸŸ¡ ä¸­ä¼˜å…ˆçº§
   â€¢ Akasha UI ç»„ä»¶è®¾è®¡

ğŸŸ¢ ä½ä¼˜å…ˆçº§
   â€¢ README æ–‡æ¡£æ›´æ–°

---
ğŸ’¡ **å»ºè®®æ“ä½œ**
â€¢ è¾“å…¥é¡¹ç›®åç§°ç»§ç»­
â€¢ è¯´ "æŸ¥çœ‹è¯¦æƒ…"
â€¢ è¯´ "æ–°ä»»åŠ¡" å¼€å§‹æ–°å·¥ä½œ
```

### 10.2 å‘½ä»¤è¡Œä¼˜åŒ–æ ¼å¼

```bash
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                 âœ… ä¸Šä¸‹æ–‡å·²æ¢å¤                               â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ ğŸ“Š ä¼šè¯æ¦‚è§ˆ                                                   â•‘
â•‘    æ—¶é—´: 2å°æ—¶å‰ | æ¶ˆæ¯: 45â†’12 (27%) | ä¼šè¯: 3               â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ ğŸš€ æ´»è·ƒé¡¹ç›®                                                   â•‘
â•‘    1. Hermes Plan  ğŸ›ï¸  (80%) æ•°æ®åˆ†æåŠ©æ‰‹                     â•‘
â•‘    2. Akasha Plan  ğŸŒ  (45%) è‡ªä¸»æ–°é—»ç³»ç»Ÿ                     â•‘
â•‘    3. Morning Brief ğŸ“°  æ™¨é—´ç®€æŠ¥                              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ ğŸ“‹ å¾…åŠä»»åŠ¡                                                   â•‘
â•‘    ğŸ”´ æ•°æ®ç®¡é“æµ‹è¯•ç”¨ä¾‹                                        â•‘
â•‘    ğŸŸ¡ Akasha UI ç»„ä»¶è®¾è®¡                                      â•‘
â•‘    ğŸŸ¢ README æ–‡æ¡£æ›´æ–°                                         â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ ğŸ’¡ å»ºè®®: è¾“å…¥é¡¹ç›®åç§°ç»§ç»­ / æŸ¥çœ‹è¯¦æƒ… / æ–°ä»»åŠ¡                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 10.3 JSON API æ ¼å¼

```json
{
  "success": true,
  "context": {
    "restored_at": "2026-02-07T18:00:00Z",
    "source_file": "/path/to/compressed_context.json",
    "quality_score": 85,
    "quality_grade": "A",
    "metadata": {
      "original_count": 45,
      "compressed_count": 12,
      "compression_ratio": 0.267,
      "age_hours": 2
    },
    "projects": [
      {
        "name": "Hermes Plan",
        "emoji": "ğŸ›ï¸",
        "description": "æ•°æ®åˆ†æåŠ©æ‰‹",
        "status": "active",
        "progress": 80,
        "location": "/home/athur/.openclaw/workspace/hermes-plan/"
      }
    ],
    "tasks": [
      {
        "task": "æ•°æ®ç®¡é“æµ‹è¯•ç”¨ä¾‹",
        "priority": "high",
        "status": "pending",
        "detail": "ç¼–å†™æ•°æ®ç®¡é“æµ‹è¯•ç”¨ä¾‹"
      }
    ],
    "operations": [
      {
        "description": "å®Œæˆæ•°æ®æ¸…æ´—æ¨¡å—",
        "timestamp": "2026-02-06T23:30:00Z"
      }
    ],
    "memory_highlights": [
      {
        "section": "Identity",
        "referenced": true
      }
    ]
  },
  "suggestions": [
    "è¾“å…¥é¡¹ç›®åç§°ç»§ç»­å·¥ä½œ",
    "è¯´ \"æŸ¥çœ‹è¯¦æƒ…\" è·å–æ›´å¤šä¿¡æ¯",
    "è¯´ \"æ–°ä»»åŠ¡\" å¼€å§‹æ–°å·¥ä½œ"
  ]
}
```

---

## é™„å½•

### A. æµ‹è¯•å‘½ä»¤

```bash
# Minimal çº§åˆ«
python3 scripts/restore_context.py --file /path/to/context.json --level minimal

# Normal çº§åˆ«
python3 scripts/restore_context.py --file /path/to/context.json --level normal

# Detailed çº§åˆ«
python3 scripts/restore_context.py --file /path/to/context.json --level detailed

# è¾“å‡ºåˆ°æ–‡ä»¶
python3 scripts/restore_context.py --output report.md --level normal
```

### B. è¯„ä¼°æ£€æŸ¥æ¸…å•

- [x] äº¤äº’æµç¨‹æµ‹è¯•
- [x] è¾“å‡ºå¯è¯»æ€§æµ‹è¯•
- [x] é”™è¯¯ä¿¡æ¯æµ‹è¯•
- [x] å¸®åŠ©æ–‡æ¡£å¯¹æ¯”
- [x] é›†æˆä½“éªŒæµ‹è¯•
- [x] Telegram é€‚é…æµ‹è¯•
- [x] æ ¼å¼ä¸€è‡´æ€§æµ‹è¯•

### C. å‚è€ƒæ–‡æ¡£

- SKILL.md - æŠ€èƒ½å®šä¹‰æ–‡æ¡£
- README.md - ä½¿ç”¨è¯´æ˜
- restore_context.py - æ ¸å¿ƒå®ç°

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2026-02-07 18:00 UTC  
**ä¸‹æ¬¡è¯„ä¼°å»ºè®®**: 2026-02-14
